
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Collaborative filtering &#8212; Knowledge base</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'data_science/ranking_task/collaborative_filtering';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Prediction functions" href="collaborative_filtering/prediction_functions.html" />
    <link rel="prev" title="Ranking task" href="../ranking_task.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.jpg" class="logo__image only-light" alt="Knowledge base - Home"/>
    <img src="../../_static/logo.jpg" class="logo__image only-dark pst-js-only" alt="Knowledge base - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Knowlege
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Data science</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../gradient_descent.html">Gradient descent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../decision_tree.html">Decision tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models_selection_methods/l2_regularisation.html">L2 (Ridge regularisation)</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../metrics.html">Metrics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../metrics/pearson_correlation.html">Pearson correlation coefficient</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/CAP.html">CAP curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/GINI.html">GINI coeficient</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/jaccard_index.html">Jaccard index</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../model_properties.html">Model properties</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../model_properties/confusion_matrix.html">Confusion matrix</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../ranking_task.html">Ranking task</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="current reference internal" href="#">Collaborative filtering</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="collaborative_filtering/prediction_functions.html">Prediction functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="collaborative_filtering/self_made_mem_based.html">Selfmade memory based</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="task_generation.html">Task generation</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="metrics.html">Metrics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="metrics/precision_k.html">precision@k</a></li>
<li class="toctree-l3"><a class="reference internal" href="metrics/recall_k.html">recall@k</a></li>
<li class="toctree-l3"><a class="reference internal" href="metrics/average_precision.html">AP@k (average precision)</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../nlp.html">NLP</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../nlp/tf_idf.html">TF-IDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nlp/text_cnn.html">Text CNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nlp/recurent_text_gen.html">Recurent text gen</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../recurrent_layer.html">Recurrent layer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../python/basics.html">Basics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/basics/syntax.html">Syntax</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/basics/syntax/operators.html">Operators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/syntax/operators/order.html">Order</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/basics/syntax/keywords.html">Keywords</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/syntax/keywords/in.html">Is in array (in)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/syntax/keywords/yield.html">yield</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/basics/syntax/functions.html">Functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/syntax/functions/parameters.html">Parameters</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/basics/syntax/oop.html">Object oriented programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/syntax/oop/interface.html">Interface</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/basics/syntax/imports.html">Imports</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/syntax/imports/from_package_import_all.html"><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">&lt;package&gt;</span> <span class="pre">import</span> <span class="pre">*</span></code></a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/syntax/exceptions.html">Exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/syntax/decorators.html">Decorators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/syntax/packages.html">Packages</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/basics/datatypes.html">Data types</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/basics/datatypes/basic.html">Basic</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/datatypes/basic/list.html">list</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/datatypes/basic/dict.html">dict</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/datatypes/basic/set.html">set</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/datatypes/datetime.html">Datetime</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/basics/files_folders.html">Files &amp; folders</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/files_folders/pathlib.html">Pathlib</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/basics/virtual_environment.html">Virutal environment in python</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/basics/unittest.html">Unittest</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/unittest/run_tests.html">Run tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/unittest/run_before_after.html">Run code before/after</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/unittest/check_error.html">Check error (assertRaises)</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/basics/unittest/mocking.html">Mocking</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/unittest/mocking/patch.html">Patch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/unittest/mocking/check_arguments.html">Check arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/unittest/mocking/syntax_options.html">Syntax options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/unittest/mocking/raising_errors.html">Raising errors</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/basics/logging.html">Logging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/logging/loggers.html">Loggers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/logging/handlers.html">Handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/logging/filters.html">Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/logging/configuration.html">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/logging/exception_information.html">Exceptions information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/logging/logging_to_file.html">Logging to file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/logging/logger_handler_level.html">Logger/Handler level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/logging/root_logger.html">Root logger</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/basics/data_classes.html">Data class</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/basics/cli_arguments.html">CLI arguments</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/cli_arguments/argparse.html">Library <code class="docutils literal notranslate"><span class="pre">argparse</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/cli_arguments/manually.html">Manually</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/basics/build_package.html">Build package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/build_package/uploading_to_pypi.html">Upload package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/basics/build_package/environment_vs_files.html">Environment vs files</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/basics/build_package/pyproject_toml.html">pyproject.toml</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/build_package/pyproject_toml/dependencies.html">Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/basics/build_package/pyproject_toml/data_files.html">Data files</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../python/packages.html">Packages</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../python/packages/collections.html"><code class="docutils literal notranslate"><span class="pre">collections</span></code> library</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/numpy.html">Numpy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/numpy/norm.html">Norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/numpy/array_splitting.html">Array splitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/numpy/apply_along_axis.html">Apply along axis</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/packages/excel_export.html">To excel import</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/zipfile.html">Zipfile</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/zipfile/extraction.html">Extraction</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/packages/ipython_magics.html">IPython magics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/packages/jinja.html">Jinja</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/docker_sdk.html">Docker SDK</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/docker_sdk/containers.html">Containers</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/packages/multi_threads.html">Multithreads in python</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/multiprocessing.html">Multiprocessing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/multiprocessing/pool.html">Pool</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/packages/transformers.html">Transformers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/packages/hashlib.html">Hashlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/packages/selenium.html">Selenium</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/ranx.html">Ranx</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/ranx/entry_queries_documents.html">Queries documents entry</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/packages/tqdm.html">TQDM</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/redis.html">Redis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/redis/redis_client.html">Redis client</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/packages/surprise.html">Surprise</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/matplotlib.html">Matplotlib</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/matplotlib/table_in_matplotlib.html">matplotlib tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/matplotlib/gif_creation.html">Gif creation</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/airflow.html">Airflow</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/airflow/run_airflow.html">Run airflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/airflow/tutorial_dag.html">Tutorial DAG</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/geopy.html">Geopy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/geopy/distances.html">Distances</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/geopy/request.html">Request</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/type_annotations.html">Type annotations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/type_annotations/complex_types.html">Complex types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/type_annotations/function_annotations.html">Function annotations</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/packages/socket.html">Socket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/packages/requests.html">Requests</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/mlflow.html">MLflow</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/mlflow/example_of_use.html">Example of usе</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/mlflow/deploy.html">Deploy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/mlflow/custom_model.html">Custom model</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/plotly.html">Plotly</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/plotly/hovers.html">Hovers</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../python/packages/plotly/dragmode.html">Dragmode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/plotly/color_from_scheme.html">Color from scheme</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/dash.html">Dash</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/dash/callbacks.html">Callbacks</a></li>





<li class="toctree-l3"><a class="reference internal" href="../../python/packages/dash/components.html">Components</a></li>





<li class="toctree-l3"><a class="reference internal" href="../../python/packages/dash/select_clear_all.html">Select/Clear All</a></li>


<li class="toctree-l3"><a class="reference internal" href="../../python/packages/dash/multipage_applications.html">Multipage applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/dash/empty_figure.html">Empty figure</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/sqlalchemy.html">SQL alchemy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/sqlalchemy/create_table.html">Create table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/sqlalchemy/query.html">Query</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/sqlalchemy/add_record.html">Add record</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/sqlalchemy/relations.html">Relations</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/packages/tkinter.html">Tkinter</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/packages/tkinter/widgets_overview.html">Widgets overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/packages/tkinter/widgets_overview/scrolling.html">Scrolling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/packages/tkinter/widgets_overview/treeview.html">Treeview</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/tkinter/pack.html">Pack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/packages/tkinter/change_elements_position.html">Change elements position</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../python/pandas.html">Pandas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/pandas/data_types.html">Data types</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/pandas/data_types/datetime.html">datetime</a></li>




<li class="toctree-l3"><a class="reference internal" href="../../python/pandas/data_types/columns_by_types.html">Columns by types</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/pandas/data_transformations.html">Data transformations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/pandas/data_transformations/groupby.html">Groupby</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/pandas/loc.html">&lt;DataFrame/Series&gt;.loc</a></li>


<li class="toctree-l2"><a class="reference internal" href="../../python/pandas/data_visualisation.html">Data visualisation</a></li>


<li class="toctree-l2"><a class="reference internal" href="../../python/pandas/styles.html">Styles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/pandas/display_options.html">Display options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/pandas/inline_columns_add.html">Inline column add (assign)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/pandas/read_sql.html">pandas.read_sql</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../python/sklearn.html">sklearn</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/sklearn/dataset_transformations.html">Dataset transformations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/sklearn/dataset_transformations/pipeline.html">Pipeline</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/sklearn/dataset_transformations/pipeline/features_names.html">Features names</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/sklearn/dataset_transformations/pipeline/memory_parameter.html"><code class="docutils literal notranslate"><span class="pre">memory</span></code> parameter(chacing)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/sklearn/dataset_transformations/columns_transformer.html">Specific processing for column</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/sklearn/dataset_transformations/features_names_out.html">Features names out</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/sklearn/dataset_transformations/one_hot_encoder.html">One hot encoder</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/sklearn/dataset_transformations/developing_transformer.html">Developing transformer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/sklearn/dataset_transformations/developing_transformer/features_names_out.html">Feature names out</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/sklearn/dataset_transformations/frozen_steps.html">Frozen steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/sklearn/dataset_transformations/estimator_to_transformer.html">Estimator to transformer</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/sklearn/grid_search_cv.html">Grid search CV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/sklearn/saving_models.html">Saving models</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/sklearn/nearest_neighbors.html">Nearest neighbors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/sklearn/nearest_neighbors/metric.html">Metric</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../python/torch.html">Torch</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/torch/tensor.html">Tensor</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/torch/tensor/creating_methods.html">Creating methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/torch/tensor/creating_methods/random_distributions.html">Random distributions</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/torch/tensor/dimentionality.html">Dimentionality</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/torch/tensor/dimentionality/reshape.html">Reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/torch/tensor/dimentionality/transpose_permute.html">Transpose/permute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/torch/tensor/dimentionality/add_dimention.html">Add dimention</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/torch/tensor/dimentionality/squeeze.html">Squeeze</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/tensor/concatenation_splitting.html">Concatenation/splitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/tensor/indexing.html">Indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/tensor/broadcasting.html">Broadcasting</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/torch/loss_functions.html">Loss functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/torch/gradient.html">Gradient</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/torch/layers.html">Layers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/layers/linear.html">Linear</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/layers/dropout.html">Dropout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/layers/normalisation_layers.html">Normalisation layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/layers/flatten_unflatten.html">Flatten/unflatten</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/torch/managing_network.html">Managing network</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/managing_network/sequential.html">Sequential</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/managing_network/saving_model.html">Saving model</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/torch/devices.html">Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/torch/data_loader.html">Data loader</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/torch/vision.html">Vision</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/vision/basic.html">Basic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/vision/augmentations.html">Augmentations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/vision/datasets.html">Datasets</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/torch/examples.html">Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/examples/logistic_regression.html">Logistic regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/examples/multiclass_task.html">Multiclass task</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/examples/texts_classification.html">Text classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/examples/mnist.html">MNIST</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/examples/symbols_classification.html">Symbols classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/examples/resnet_finetuning.html">Resnet finetuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/examples/cnn_classification.html">CNN classification</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python/torch/examples/unet.html">Unet</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python/torch/examples/unet/oxford_pet.html">Oxford pet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python/torch/examples/unet/voc_segmentation.html">Voc segmentation</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/examples/gan.html">GAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/torch/examples/conditional_gan.html">Conditional GAN</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../python/fastapi.html">Fastapi</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../python/fastapi/run_application.html">Run application</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/fastapi/requests.html">Requests</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/fastapi/requests/request_object.html">Request object</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/fastapi/responses.html">Responses</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/fastapi/responses/json.html">JSON</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/fastapi/responses/exceptions.html">Exceptions</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/fastapi/logging.html">Logging</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/fastapi/documentation.html">Documentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/fastapi/documentation/parameters.html">Parameters</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/fastapi/cache.html">Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/fastapi/cors.html">CORS</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Math</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../math/union_probability.html">Union probability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../math/conditional_probability.html">Сonditional probability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../math/cent_limit_theorem.html">Central limit theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../math/maximum_likelihood.html">Maximum likelihood</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../math/latex.html">Latex</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../math/stat_testing.html">Statistical testing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../math/stat_testing/binomial_test.html">Binomial test</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Algorithms</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../algorithms/complexity.html">Complexity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../algorithms/trees.html">Trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../algorithms/dynamic_prog.html">Dynamic programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../algorithms/quick_sort.html">Quick sort</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../algorithms/specific_tasks.html">Specific tasks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../algorithms/specific_tasks/emergency_task.html">Emergency task</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../algorithms/specific_tasks/sinking_islands.html">Sinling islands</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Docker</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../docker/overview.html">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../docker/containers.html">Containers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../docker/containers/run.html">Run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../docker/containers/execute_in.html">Execute in</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../docker/containers/check_logs.html">Check logs</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../docker/images.html">Images</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../docker/images/build_image.html">Build image</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../docker/images/build_image/build_context.html">Build context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../docker/images/build_image/ignore_files.html">Ignore files</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../docker/images/docker_file_directives.html">Dockerfile directives</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../docker/images/docker_file_directives/execute_with_run.html">Execute with start</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../docker/volumes.html">Volumes</a></li>

<li class="toctree-l1 has-children"><a class="reference internal" href="../../docker/networks.html">Networks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../docker/networks/default_networks.html">Default networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../docker/networks/container_communication.html">Containers communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../docker/networks/local_network.html">Local network</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../docker/access.html">Acesss to containers</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../docker/compose.html">Compose</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../docker/compose/up_down.html">Up/down</a></li>

</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Git</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../git/init.html">Init repository</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../git/file_stages.html">File statuses</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../git/file_stages/commit.html">Commit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../git/file_stages/remove_from_staging.html">Remove from staging</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../git/diff.html">Difference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git/checkout.html">Checkout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git/branches.html">Branches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git/log.html">Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git/merge.html">Merge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git/previous_commit.html">Previous commit <code class="docutils literal notranslate"><span class="pre">~</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git/ignore.html">How git ignore works</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git/stash.html">Stash</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SQL</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../sql/intro.html">Intro</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../sql/select.html">Select</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../sql/select/join.html">JOIN</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../sql/select/join/join_types.html">Join types</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql/select/sorting.html">Sorting (ORDER BY)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql/select/unique_values.html">Unique values (DISTINCT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql/select/empty_values.html">Empty values</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../sql/select/aggregation_functions.html">Aggregation functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../sql/select/aggregation_functions/collect_array.html">Collect array</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../sql/select/group_by.html">Group by</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../sql/select/group_by/conditions_on_aggregats.html">Conditions on aggregats (HAVING)</a></li>



</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../sql/select/window_functions.html">Window functions (OVER)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../sql/select/window_functions/functions.html">Functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../sql/select/window_functions/functions/values_shifting_lag_lead.html">Values shifting (LAG/LEAD)</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql/select/expand_array.html">Expand array</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql/select/conditional.html">Conditional (CASE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql/select/records_range.html">Records range (OFFSET/LIMIT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql/select/performance.html">Performance</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../sql/operating_tables.html">Operating tables</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sql/operating_tables/tables_properties.html">Tables properties</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../sql/datatypes.html">Data types</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../sql/datatypes/datetime.html">Date and time</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../sql/datatypes/datetime/date_components.html">Date components (DATE_PART)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sql/datatypes/datetime/add_period.html">Add period</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql/datatypes/json.html">JSON</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../sql/versions_issues.html">Versions issues</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../sql/python_interaction.html">Python interaction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sql/python_interaction/python_from_container.html">Python from container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql/python_interaction/python_on_host.html">Python on host</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql/python_interaction/create_database.html">Create database</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Layout</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../layout/sources.html">Sources</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../layout/html.html">HTML</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../layout/html/other.html">Other</a></li>




<li class="toctree-l2"><a class="reference internal" href="../../layout/html/tables.html">Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../layout/html/lists.html">List tags</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../layout/css.html">CSS</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../layout/css/other.html">Other</a></li>







<li class="toctree-l2"><a class="reference internal" href="../../layout/css/style_application.html">Style application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../layout/css/margin.html">Margin (out space)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../layout/css/padding.html">Padding (in space)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../layout/css/overflow.html">Overflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../layout/css/elements_positions.html">Elements position (<code class="docutils literal notranslate"><span class="pre">display</span></code>)</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../layout/forms.html">Forms</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../other/linux.html">Linux</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../other/linux/bash.html">Bash</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other/linux/variables.html">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other/linux/curl.html">Curl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other/linux/backup.html">Backup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other/linux/ssh.html">SSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other/linux/cron.html">Cron</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../other/python_apache.html">Python with apache</a></li>







<li class="toctree-l1"><a class="reference internal" href="../../other/kubernetes.html">Kubernetes</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../other/redis.html">Redis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../other/redis/zset.html">Zset</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../other/nginx.html">Nginx</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../other/nginx/reverse_proxy.html">Reverse proxy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../other/nginx/reverse_proxy/proxy_pass.html">Proxy pass</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../other/nginx/reverse_proxy/cache.html">Cache</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../other/nginx/variables.html">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other/nginx/configuration.html">Configuration</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../other/gitlab.html">Gitlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other/ansible.html">Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other/java_script.html">Java script</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/fedorkobak/knowledge" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/data_science/ranking_task/collaborative_filtering.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Collaborative filtering</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-based">Memory based</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#user-based">User based</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#item-based">Item based</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generalised-algorithm">Generalised algorithm</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-based">Model based</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="collaborative-filtering">
<h1>Collaborative filtering<a class="headerlink" href="#collaborative-filtering" title="Link to this heading">#</a></h1>
<p>It’s type of models that requires only matrix <span class="math notranslate nohighlight">\(R\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<section id="memory-based">
<h2>Memory based<a class="headerlink" href="#memory-based" title="Link to this heading">#</a></h2>
<section id="user-based">
<h3>User based<a class="headerlink" href="#user-based" title="Link to this heading">#</a></h3>
<p>Aka <strong>user-user filtering</strong>.</p>
<p>This method is based on approach, that if users ranked their common items close it means that it have sence to recommend them same items in future:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p></p></th>
<th class="head text-left"><p><span class="math notranslate nohighlight">\(i_1\)</span></p></th>
<th class="head text-left"><p><span class="math notranslate nohighlight">\(i_2\)</span></p></th>
<th class="head text-left"><p>…</p></th>
<th class="head text-left"><p><span class="math notranslate nohighlight">\(i_n\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(u_1\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{11}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{12}\)</span></p></td>
<td class="text-left"><p>…</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{1n}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(u_2\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{21}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{22}\)</span></p></td>
<td class="text-left"><p>…</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{2n}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>…</p></td>
<td class="text-left"><p>…</p></td>
<td class="text-left"><p>…</p></td>
<td class="text-left"><p>…</p></td>
<td class="text-left"><p>…</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(u_m\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{m1}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{m2}\)</span></p></td>
<td class="text-left"><p>…</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{mn}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<!--
# GENERATE arr
np.random.seed(10)
sample_size = 10

arr = np.random.randint(low=1, high=11, size=[1, sample_size])
arr = np.concatenate(
    [
        arr,
        arr + np.random.randint(-1, 2, size=sample_size),
        np.abs(arr - 10) + np.random.randint(-1, 2, size=sample_size)
    ],
    axis = 0
)
arr = np.where((arr>10), 10 , arr)
arr = np.where((arr<1), 1, arr)

# Display display it as markdown

print(pd.DataFrame(
    arr,
    index=[f"$u_{{{i+1}}}$" for i in range(arr.shape[0])], 
    columns=[f"$i_{{{j+1}}}$" for j in range(arr.shape[1])]
).to_markdown())
-->
<p>Consider a simple example:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p></p></th>
<th class="head text-right"><p><span class="math notranslate nohighlight">\(i_{1}\)</span></p></th>
<th class="head text-right"><p><span class="math notranslate nohighlight">\(i_{2}\)</span></p></th>
<th class="head text-right"><p><span class="math notranslate nohighlight">\(i_{3}\)</span></p></th>
<th class="head text-right"><p><span class="math notranslate nohighlight">\(i_{4}\)</span></p></th>
<th class="head text-right"><p><span class="math notranslate nohighlight">\(i_{5}\)</span></p></th>
<th class="head text-right"><p><span class="math notranslate nohighlight">\(i_{6}\)</span></p></th>
<th class="head text-right"><p><span class="math notranslate nohighlight">\(i_{7}\)</span></p></th>
<th class="head text-right"><p><span class="math notranslate nohighlight">\(i_{8}\)</span></p></th>
<th class="head text-right"><p><span class="math notranslate nohighlight">\(i_{9}\)</span></p></th>
<th class="head text-right"><p><span class="math notranslate nohighlight">\(i_{10}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(u_{1}\)</span></p></td>
<td class="text-right"><p>10</p></td>
<td class="text-right"><p>5</p></td>
<td class="text-right"><p>1</p></td>
<td class="text-right"><p>2</p></td>
<td class="text-right"><p>10</p></td>
<td class="text-right"><p>1</p></td>
<td class="text-right"><p>2</p></td>
<td class="text-right"><p>9</p></td>
<td class="text-right"><p>10</p></td>
<td class="text-right"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(u_{2}\)</span></p></td>
<td class="text-right"><p>10</p></td>
<td class="text-right"><p>4</p></td>
<td class="text-right"><p>2</p></td>
<td class="text-right"><p>1</p></td>
<td class="text-right"><p>9</p></td>
<td class="text-right"><p>1</p></td>
<td class="text-right"><p>3</p></td>
<td class="text-right"><p>8</p></td>
<td class="text-right"><p>10</p></td>
<td class="text-right"><p>2</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(u_{3}\)</span></p></td>
<td class="text-right"><p>1</p></td>
<td class="text-right"><p>4</p></td>
<td class="text-right"><p>8</p></td>
<td class="text-right"><p>9</p></td>
<td class="text-right"><p>1</p></td>
<td class="text-right"><p>10</p></td>
<td class="text-right"><p>8</p></td>
<td class="text-right"><p>1</p></td>
<td class="text-right"><p>1</p></td>
<td class="text-right"><p>9</p></td>
</tr>
</tbody>
</table>
</div>
<p>Without any special techniques, you can see that user 1 and user 2 have very similar preferences. But user 3 has completely different preferences.</p>
<p>In the following cell, the <span class="math notranslate nohighlight">\(R\)</span> matrix under consideration is defined as a numpy array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">9</span><span class="p">]</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>So let’s try to formalise their similarity somehow - in this case we’ll use Pirson’s correlation coefficient:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corrmatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Similarity between first and second user:&quot;</span><span class="p">,</span> <span class="n">corrmatrix</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Similarity between second and third user:&quot;</span><span class="p">,</span> <span class="n">corrmatrix</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Similarity between first and second user: 0.9802681400094546
Similarity between second and third user: -0.9650036744440637
</pre></div>
</div>
</div>
</div>
<p>So we proved that the first client is close to the second, but the third is very different. So according to our approach, we are more likely to recommend to the second user the games that the first one liked and vice versa.</p>
</section>
<section id="item-based">
<h3>Item based<a class="headerlink" href="#item-based" title="Link to this heading">#</a></h3>
<p>Aka <strong>item-item filtering</strong>.</p>
<p>Item based approach technically same as user based. Here we are looking for items that are similar in <span class="math notranslate nohighlight">\(r_{ij}, i=\overline{1,n}\)</span> by the same users.</p>
<p>So the <span class="math notranslate nohighlight">\(R\)</span> matrix is just transposed compared to the user based approach:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p></p></th>
<th class="head text-left"><p><span class="math notranslate nohighlight">\(u_1\)</span></p></th>
<th class="head text-left"><p><span class="math notranslate nohighlight">\(u_2\)</span></p></th>
<th class="head text-left"><p>…</p></th>
<th class="head text-left"><p><span class="math notranslate nohighlight">\(u_m\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><span class="math notranslate nohighlight">\(i_1\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{11}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{12}\)</span></p></td>
<td class="text-left"><p>…</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{1m}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(i_2\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{21}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{22}\)</span></p></td>
<td class="text-left"><p>…</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{2m}\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>…</p></td>
<td class="text-left"><p>…</p></td>
<td class="text-left"><p>…</p></td>
<td class="text-left"><p>…</p></td>
<td class="text-left"><p>…</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><span class="math notranslate nohighlight">\(i_n\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{m1}\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{m2}\)</span></p></td>
<td class="text-left"><p>…</p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(r_{mn}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Note</strong> here, in contrast to the definition given above, the order of indexing of the elements of the matrix <span class="math notranslate nohighlight">\(R\)</span> is changed (<span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> are swapped). That is, here <span class="math notranslate nohighlight">\(r_{ji}\)</span>.</p>
</section>
<section id="generalised-algorithm">
<h3>Generalised algorithm<a class="headerlink" href="#generalised-algorithm" title="Link to this heading">#</a></h3>
<p>Here we take a general look at how collaborative filtering works. It will have identical operations in the user and item based cases, so we will only consider the abstract matrix <span class="math notranslate nohighlight">\(R\)</span>. So we have target value <span class="math notranslate nohighlight">\(r_{ij}\)</span> for abstract combination of row <span class="math notranslate nohighlight">\(i\)</span> and column <span class="math notranslate nohighlight">\(j\)</span>. For the sake of simplicity, I’ll sometimes refer to lines as objects.</p>
<p><strong>Estimate similarities</strong> For each pair of rows, let’s say rows <span class="math notranslate nohighlight">\(k,t,t\neq k\)</span>, we compute some metric that estimates their similarities <span class="math notranslate nohighlight">\(Sim(k,t)\)</span>, for example the Pearson correlation coefficient.</p>
<p>An important nuance is that for some <span class="math notranslate nohighlight">\(r_{ij}\)</span> can be undefined, which means that the combination <span class="math notranslate nohighlight">\(i,j\)</span> did not occur. So let’s denote <span class="math notranslate nohighlight">\(I_k\)</span> and <span class="math notranslate nohighlight">\(I_t\)</span> as sets of defined relevancies for the <span class="math notranslate nohighlight">\(k\)</span>th and <span class="math notranslate nohighlight">\(t\)</span>th rows, respectively. So set of columns that have defined ratings both for <span class="math notranslate nohighlight">\(k\)</span>th and <span class="math notranslate nohighlight">\(t\)</span>th rows can be denoted as <span class="math notranslate nohighlight">\(J=I_k \cap I_t\)</span>.</p>
<p><span class="math notranslate nohighlight">\(Sim(k,t),t\neq k\)</span> - similarity measure of the <span class="math notranslate nohighlight">\(k\)</span>-th and <span class="math notranslate nohighlight">\(t\)</span>-th rows. The simplest and perhaps most popular - Pearson’s correlation coefficient:</p>
<div class="math notranslate nohighlight">
\[Sim(k,t) = 
\frac{\sum_{j\in J}(r_{kj}-\overline{r_{k}})(r_{tj}-\overline{r_{t}})}
{\sqrt{\sum_{j\in J}(r_{kj}-\overline{r_{k}})^2}\sqrt{\sum_{j \in J}(r_{tj}-\overline{r_{t}})^2}}
\]</div>
<p><strong>Estimate rating</strong>. Once we have computed similarities between all rows, we can make a prediction about the relevance of <span class="math notranslate nohighlight">\(j\)</span>-th column to <span class="math notranslate nohighlight">\(k'\)</span> row. Usually it’s a function that uses similarities between <span class="math notranslate nohighlight">\(k'\)</span> and all other rows that have rating for <span class="math notranslate nohighlight">\(j\)</span>-th column.</p>
<p>Really popular option is:</p>
<div class="math notranslate nohighlight">
\[\hat{r}_{k'j}=\overline{r_k'} + \frac{\sum_{t\in P_k';(j)} Sim(k',t)(r_{k'j}-\overline{r_k'})}{\sum_{t\in P_k'(j)} |Sim(k',t)|}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P_k'(j)\)</span> - the set of closest rows to target object <span class="math notranslate nohighlight">\(k'\)</span>, who have speciﬁed ratings for item <span class="math notranslate nohighlight">\(j\)</span>. Can be defined anyhow;</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{r}_{k'j}\)</span> - estimation of the relevance of <span class="math notranslate nohighlight">\(j\)</span>-th column to the <span class="math notranslate nohighlight">\(k'\)</span>-th row.</p></li>
</ul>
<p>Check more description about this function and other options in <a class="reference internal" href="collaborative_filtering/prediction_functions.html"><span class="std std-doc">prediction functions page</span></a>.</p>
<p><strong>Finally</strong> for <span class="math notranslate nohighlight">\(k'\)</span>-row we select those <span class="math notranslate nohighlight">\(j\)</span> that have the best <span class="math notranslate nohighlight">\(\hat{r}_{k'j}\)</span>, so final answer is <span class="math notranslate nohighlight">\(j' = argmax_{j}\left[\hat{r}_{k'j}\right]\)</span></p>
</section>
</section>
<section id="model-based">
<h2>Model based<a class="headerlink" href="#model-based" title="Link to this heading">#</a></h2>
<p>Model-based methods work by building models that attempt to predict a rating for a user-item pair by using ratings as features.</p>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./data_science/ranking_task"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../ranking_task.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Ranking task</p>
      </div>
    </a>
    <a class="right-next"
       href="collaborative_filtering/prediction_functions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Prediction functions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-based">Memory based</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#user-based">User based</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#item-based">Item based</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generalised-algorithm">Generalised algorithm</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-based">Model based</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Fedor Kobak
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>